{
    "$schema": "https://json-schema.org/draft/2019-09/schema",
    "type": "object",
    "description": "Information about the library preparation.",
    "unevaluatedProperties": false,
    "title": "Library preparation",
    "name": "library_preparation",
    "allOf": [
        {
            "type": "object",
            "$ref": "/system/system",
            "$comment": "This loads the system needed properties outside the 'content' field. For implementation outside of MorPhiC, please ensure the system properties satisfy your implementation. These properties are not meant for the user to see.",
            "properties": {
                "accessions": {
                    "items": {
                        "anyOf": [
                            {
                                "isValidIdentifier": {
                                    "prefix": "biosample"
                                }
                            },
                            {
                                "isValidIdentifier": {
                                    "prefix": "insdc.sra"
                                }
                            }
                        ]
                    }
                },
                "described_by": {
                    "pattern": "^.*/type/[0-9]+.[0-9]+.[0-9]+/biomaterial/library_preparation$"
                },
                "schema_type": {
                    "const": "library_preparation",
                    "default": "library_preparation"
                }
            }
        }
    ],
    "properties": {
        "content": {
            "type": "object",
            "title": "Content",
            "required": [
                "average_fragment_size",
                "library_preparation_id"
            ],
          "dependentRequired": {
            "library_concentration_unit": [
              "library_concentration_value"
            ],
            "library_concentration_value": [
              "library_concentration_unit"
            ],
            "library_final_yield_unit": [
              "library_final_yield_value"
            ],
            "library_final_yield_value": [
              "library_final_yield_unit"
            ],
            "library_input_amount_unit": [
              "library_input_amount_value"
            ],
            "library_input_amount_value": [
              "library_input_amount_unit"
            ]
          },
            "properties": {
                "average_fragment_size": {
                    "type": "integer",
                    "description": "Average fragment size for the transcripts in the library preparation.",
                    "title": "Average fragment size",
                    "examples": [
                        150,
                        256
                    ]
                },
                "library_concentration_unit": {
                    "$ref": "/system/ontology",
                    "title": "Library concentration unit",
                    "properties": {
                        "ontology": {
                            "title": "Library concentration unit - Ontology ID",
                            "graphRestriction": {
                                "ontologies": [
                                    "obo:uo"
                                ],
                                "classes": [
                                    "UO:0000052"
                                ],
                                "relations": [
                                    "rdfs:subClassOf"
                                ],
                                "direct": false,
                                "include_self": false
                            },
                            "examples": [
                                "UO:0000275",
                                "UO:0010050"
                            ]
                        },
                        "text": {
                            "title": "Library concentration unit",
                            "examples": [
                                "microgram per mililiter",
                                "nanogram per microliter"
                            ]
                        }
                    }
                },
                "library_concentration_value": {
                    "type": "number",
                    "description": "Value of the library concentration.",
                    "title": "Library concentration value",
                    "examples": [
                        7.5,
                        8,
                        9.1
                    ]
                },
                "library_final_yield_unit": {
                    "$ref": "/system/ontology",
                    "title": "Library final yield unit",
                    "properties": {
                        "ontology": {
                            "title": "Library final yield unit - Ontology ID",
                            "graphRestriction": {
                                "ontologies": [
                                    "obo:uo"
                                ],
                                "classes": [
                                    "UO:1000021"
                                ],
                                "relations": [
                                    "rdfs:subClassOf"
                                ],
                                "direct": false,
                                "include_self": false
                            },
                            "examples": [
                                "UO:0000024",
                                "UO:0000025"
                            ]
                        },
                        "text": {
                            "title": "Library final yield unit",
                            "examples": [
                                "microgram",
                                "nanogram"
                            ]
                        }
                    }
                },
                "library_final_yield_value": {
                    "type": "number",
                    "description": "Value of the library final yield.",
                    "title": "Library final yield value",
                    "examples": [
                        7.5,
                        8,
                        9.1
                    ]
                },
                "library_input_amount_unit": {
                    "$ref": "/system/ontology",
                    "title": "Library input amount unit",
                    "properties": {
                        "ontology": {
                            "title": "Library input amount unit - Ontology ID",
                            "graphRestriction": {
                                "ontologies": [
                                    "obo:uo"
                                ],
                                "classes": [
                                    "UO:0000095"
                                ],
                                "relations": [
                                    "rdfs:subClassOf"
                                ],
                                "direct": false,
                                "include_self": false
                            },
                            "examples": [
                                "UO:0000010",
                                "UO:0000034"
                            ]
                        },
                        "text": {
                            "title": "Library input amount unit",
                            "examples": [
                                "microliter",
                                "nanoliter"
                            ]
                        }
                    }
                },
                "library_input_amount_value": {
                    "type": "number",
                    "description": "Value of the library input amount.",
                    "title": "Library input amount value",
                    "examples": [
                        7.5,
                        8,
                        9.1
                    ]
                },
                "library_pcr_cycles": {
                    "type": "integer",
                    "description": "Number of PCR cycles performed for this library.",
                    "title": "Library PCR cycles",
                    "examples": [
                        150,
                        256
                    ]
                },
                "library_preparation_description": {
                    "$ref": "#/definitions/non_empty_string",
                    "description": "A general description of the library preparation.",
                    "title": "Library preparation description",
                    "examples": [
                        "Run 1, batch 1S, library preparation from KOLF2.2J derived trophoblasts"
                    ]
                },
                "library_preparation_id": {
                    "$ref": "#/definitions/entity_id",
                    "description": "A unique ID for the library preparation.",
                    "title": "Library preparation ID",
                    "examples": [
                        "kolf2_2j_knockout_1_trophoblast_library_preparation1S"
                    ]
                }
            }
        }
    },
    "definitions": {
        "non_empty_string": {
            "type": "string",
            "minLength": 1
        },
        "non_empty_array": {
            "type": "array",
            "minItems": 1
        },
        "entity_id": {
            "type": "string",
            "format": "regex",
            "pattern": "^[a-zA-Z0-9_]*$",
            "minLength": 1
        }
    }
}